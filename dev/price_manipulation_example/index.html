<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Price Manipulation Example · ABMPredictionMarkets</title><meta name="title" content="Price Manipulation Example · ABMPredictionMarkets"/><meta property="og:title" content="Price Manipulation Example · ABMPredictionMarkets"/><meta property="twitter:title" content="Price Manipulation Example · ABMPredictionMarkets"/><meta name="description" content="Documentation for ABMPredictionMarkets."/><meta property="og:description" content="Documentation for ABMPredictionMarkets."/><meta property="twitter:description" content="Documentation for ABMPredictionMarkets."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ABMPredictionMarkets logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ABMPredictionMarkets</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../basic_example/">Basic Example</a></li><li><a class="tocitem" href="../arbitrage_example/">Arbitrage Example</a></li><li class="is-active"><a class="tocitem" href>Price Manipulation Example</a><ul class="internal"><li><a class="tocitem" href="#Load-Dependencies"><span>Load Dependencies</span></a></li><li><a class="tocitem" href="#CPMM-Agent"><span>CPMM Agent</span></a></li><li><a class="tocitem" href="#Constant-Product-Market-Maker"><span>Constant Product Market Maker</span></a></li><li><a class="tocitem" href="#Model-Step-Function"><span>Model Step Function</span></a></li><li><a class="tocitem" href="#Agent-Step-Function"><span>Agent Step Function</span></a></li><li><a class="tocitem" href="#Model-Initialization-Function"><span>Model Initialization Function</span></a></li><li><a class="tocitem" href="#Set-RNG-Seed"><span>Set RNG Seed</span></a></li><li><a class="tocitem" href="#Configure-Model"><span>Configure Model</span></a></li><li><a class="tocitem" href="#Simulate-the-Model"><span>Simulate the Model</span></a></li><li><a class="tocitem" href="#Plot-the-Results"><span>Plot the Results</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Price Manipulation Example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Price Manipulation Example</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/itsdfish/ABMPredictionMarkets.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/itsdfish/ABMPredictionMarkets.jl/blob/main/docs/src/price_manipulation_example.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Price-Manipulation-Example"><a class="docs-heading-anchor" href="#Price-Manipulation-Example">Price Manipulation Example</a><a id="Price-Manipulation-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Price-Manipulation-Example" title="Permalink"></a></h1><p>Our goal in this example is to develop an agent based model of price manipulation in a prediction market as described in the arXiv paper entitled <em>How manipulable are prediction markets?</em> (Rasooly &amp; Rozzi, 2025). In this example, a small set of agents trade shares in a prediction market based on a constant product market maker. During the trading period, a manipulator increases the current market price by .05 units. The model illustrates partial recovery of the market price, similar to what was found empirically in a large scale field experiment conducted by the authors (Rasooly &amp; Rozzi, 2025).</p><p>If you prefer to skip the explanation below, click on the ▶ icon to reveal a full version of the code.  </p><details>
<summary><b>Full Code</b></summary><pre><code class="language-julia hljs">using ABMPredictionMarkets
using ABMPredictionMarkets: compute_optimal_purchase
using ABMPredictionMarkets: compute_price
using ABMPredictionMarkets: cost_to_shares
using ABMPredictionMarkets: get_market
using ABMPredictionMarkets: init
using ABMPredictionMarkets: price_to_cost
using ABMPredictionMarkets: shares_to_cost
using ABMPredictionMarkets: update_reserves!
using ABMPredictionMarkets: transact!
using Agents
using Distributions
using Plots
using Random
import ABMPredictionMarkets: agent_step!

@agent struct CPMMAgent(NoSpaceAgent) &lt;: MarketAgent
    judgments::Vector{Vector{Float64}}
    money::Float64
    shares::Vector{Vector{Float64}}
    λ::Float64
end

function model_step!(model)
    agent = random_agent(model)
    agent_step!(agent, model)
    if abmtime(model) ∈ model.times
        market = get_market(model)
        current_price = compute_price(market, 1, true)
        target_price = min(1, current_price + 0.05)
        cost = price_to_cost(market, target_price, 1, true)
        n_shares = cost_to_shares(market, cost, 1, true)
        update_reserves!(market, n_shares, cost, 1, true)
        push!(model.trade_volume[1], n_shares)
        push!(model.market_prices[1], compute_price(market, 1, true))
    end
    return nothing
end

function agent_step!(agent, ::CPMMAgent, market::AbstractCPMM, model)
    (; judgments, λ) = agent
    if agent.shares[1][1] &gt; 0
        # sell yes shares
        n_shares = -agent.shares[1][1]
        cost = shares_to_cost(market, n_shares, 1, true)
        order = AMMOrder(; id = agent.id, option = true, cost, n_shares)
        transact!(order, market, model, 1)
        pop!(model.trade_volume[1])
        pop!(model.market_prices[1])
    end
    if agent.shares[1][2] &gt; 0
        # sell no shares
        n_shares = -agent.shares[1][2]
        cost = shares_to_cost(market, n_shares, 1, false)
        order = AMMOrder(; id = agent.id, option = false, cost, n_shares)
        transact!(order, market, model, 1)
        pop!(model.trade_volume[1])
        pop!(model.market_prices[1])
    end

    price = compute_price(market, 1, true)
    belief = (1 - λ) * judgments[1][1] + λ * price
    if belief ≥ price
        # buy yes shares
        cost = compute_optimal_purchase(agent, market, belief, 1, true)
        n_shares = cost_to_shares(market, cost, 1, true)
        order = AMMOrder(; id = agent.id, option = true, cost, n_shares)
        transact!(order, market, model, 1)
    elseif belief &lt; price
        # buy no shares
        cost = compute_optimal_purchase(agent, market, belief, 1, false)
        n_shares = cost_to_shares(market, cost, 1, false)
        order = AMMOrder(; id = agent.id, option = false, cost, n_shares)
        transact!(order, market, model, 1)
    end
    return nothing
end

function initialize(
    agent_type::Type{&lt;:CPMMAgent};
    n_agents,
    λ,
    money,
    yes_reserves,
    no_reserves,
    manipulate_time
)
    yes_reserves = deepcopy(yes_reserves)
    no_reserves = deepcopy(no_reserves)
    space = nothing
    model = StandardABM(
        agent_type,
        space;
        properties = CPMM(; yes_reserves, no_reserves, times = [manipulate_time]),
        model_step!,
        scheduler = Schedulers.Randomly()
    )
    for i ∈ 1:n_agents
        p = (i - 1) / (n_agents - 1)
        judgments = [[p, 1-p]]
        add_agent!(
            model;
            judgments,
            money,
            λ,
            shares = [zeros(2)]
        )
    end
    return model
end

config = (
    n_agents = 11,
    λ = 0.0,
    money = 100,
    no_reserves = [1000.0],
    yes_reserves = [1000.0],
    manipulate_time = 100,
)

market_prices = map(1:1000) do _
    model = initialize(CPMMAgent; config...)
    run!(model, 200)
    model.market_prices[1]
end

plot(
    mean(market_prices),
    ylims = (.4, .6),
    xlabel = &quot;Day&quot;,
    ylabel = &quot;Price of Yes Share&quot;,
    linewidth = 2.5,
    grid = false,
    leg = false,
)
hline!([.5], color = :black, linestyle = :dash)</code></pre></details><h2 id="Load-Dependencies"><a class="docs-heading-anchor" href="#Load-Dependencies">Load Dependencies</a><a id="Load-Dependencies-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Dependencies" title="Permalink"></a></h2><p>Our first step is to load the required dependencies for simulation and plotting. In addition, we will import the function <code>agent_step!</code> so we can create a new method defining the behavior of the agents in the price manipulation simulation.</p><pre><code class="language-julia hljs">using ABMPredictionMarkets
using ABMPredictionMarkets: compute_optimal_purchase
using ABMPredictionMarkets: compute_price
using ABMPredictionMarkets: cost_to_shares
using ABMPredictionMarkets: get_market
using ABMPredictionMarkets: init
using ABMPredictionMarkets: price_to_cost
using ABMPredictionMarkets: shares_to_cost
using ABMPredictionMarkets: update_reserves!
using ABMPredictionMarkets: transact!
using Agents
using Distributions
using Plots
using Random
import ABMPredictionMarkets: agent_step!</code></pre><h2 id="CPMM-Agent"><a class="docs-heading-anchor" href="#CPMM-Agent">CPMM Agent</a><a id="CPMM-Agent-1"></a><a class="docs-heading-anchor-permalink" href="#CPMM-Agent" title="Permalink"></a></h2><p>The code block below defines an agent type called <em>CPMMAgent</em>. In this agent type, the first three fields are required, and the fourth field is an optional parameter included for this specific simulation scenario. The fields are defined as follows:</p><ul><li><code>judgements</code>: a vector of vectors in which elements of the outer vector represent individual prediction markets and elements of the inner vectors represent subjective price estimates of options of a given market. For example <code>judgements = [[.3,.7],[.2,.8]]</code> contains price estimates for two prediction markets and <code>[.3,.7]</code> represents the price estimates of the first and second options of the first prediction market. Currently, <code>CPMM</code> only supports binary prediction markets, but multiple prediction markets may be used within the same simulation. </li><li><code>money</code>: the amount of money in dollars available to purchase shares.</li><li><code>shares</code>: a vector of vectors recording the number of shares the agent owns. Similar to the field <code>judgments</code> elements of the outer vector represent individual prediction markets and elements of inner vector represent different options within a prediction market. </li><li><code>λ</code>: the weight given to an estimated price in <code>judgments</code> relative to the current market place, such that <span>$\lambda \in \left[0, 1 \right]$</span>.  </li></ul><pre><code class="language-julia hljs">@agent struct CPMMAgent(NoSpaceAgent) &lt;: MarketAgent
    judgments::Vector{Vector{Float64}}
    money::Float64
    shares::Vector{Vector{Float64}}
    λ::Float64
end</code></pre><h2 id="Constant-Product-Market-Maker"><a class="docs-heading-anchor" href="#Constant-Product-Market-Maker">Constant Product Market Maker</a><a id="Constant-Product-Market-Maker-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-Product-Market-Maker" title="Permalink"></a></h2><p>The price manipulation simulation uses a type of prediction market called a constant product market maker (CPMM). A CPMM is a type of automated market maker which uses an algorithm ensure liquidity in a market and adjust the price of an asset based on demand. The price of a share in a CPMM is determined by the product of the amount of reserves for <em>yes</em> shares and <em>no</em> shares:</p><p class="math-container">\[r_y \cdot r_n = k,\]</p><p>where <span>$r_y$</span> and <span>$r_n$</span> are the reserves for <em>yes</em> and <em>no</em> shares, respectively. Share prices are constrained such that the product of <em>yes</em> and <em>no</em> reserves must equal the constant <span>$k$</span>, as shown below:</p><details>
<summary><b>Plot Code</b></summary><pre><code class="language-julia hljs">reserve_plot = let
    x = .01:.01:250
    y = 1000 ./ x
    plot(x, y, xlabel = &quot;Yes Reserves&quot;, ylabel = &quot;No Reserves&quot;, lims = (0, 250), grid = false, leg = false)
end
nothing</code></pre></details><pre><code class="language-julia hljs">reserve_plot</code></pre><img src="b4f5c908.svg" alt="Example block output"/><p>The price is computed as the ratio of reserves. For example, the price for a <em>yes</em> share is <span>$\frac{r_n}{r_y + r_n}$</span>.</p><h2 id="Model-Step-Function"><a class="docs-heading-anchor" href="#Model-Step-Function">Model Step Function</a><a id="Model-Step-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Step-Function" title="Permalink"></a></h2><p>On each iteration of the simulation, the function <code>model_step!</code> is called, which performs the following actions:</p><ol><li>Select a random agent and trade via the <code>agent_step!</code> function.</li><li>Manipulate the current price by <span>$.05$</span> units at specified iterations. </li></ol><pre><code class="language-julia hljs">function model_step!(model)
    agent = random_agent(model)
    agent_step!(agent, model)
    if abmtime(model) ∈ model.times
        market = get_market(model)
        current_price = compute_price(market, 1, true)
        target_price = min(1, current_price + 0.05)
        cost = price_to_cost(market, target_price, 1, true)
        n_shares = cost_to_shares(market, cost, 1, true)
        update_reserves!(market, n_shares, cost, 1, true)
        push!(model.trade_volume[1], n_shares)
        push!(model.market_prices[1], compute_price(market, 1, true))
    end
    return nothing
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">model_step! (generic function with 1 method)</code></pre><h2 id="Agent-Step-Function"><a class="docs-heading-anchor" href="#Agent-Step-Function">Agent Step Function</a><a id="Agent-Step-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Agent-Step-Function" title="Permalink"></a></h2><p>The <code>agent_step!</code>, which is called in the <code>model_step!</code> function above, defines the trading behavior of the agents. <code>agent_step!</code> performs the following actions:</p><ol><li>sell any available <em>yes</em> or <em>no</em> shares</li><li>define belief <span>$b$</span> for price of <em>yes</em> shares as <span>$b = \lambda \cdot p + (1 - \lambda) \cdot j$</span>, where <span>$p$</span> is the current price of a <em>yes</em> share and <span>$j$</span> is the estimated price. Buy yes if <span>$b \leq j$</span>, buy no otherwise.</li></ol><pre><code class="language-julia hljs">function agent_step!(agent, ::CPMMAgent, market::AbstractCPMM, model)
    (; judgments, λ) = agent
    if agent.shares[1][1] &gt; 0
        # sell yes shares
        n_shares = -agent.shares[1][1]
        cost = shares_to_cost(market, n_shares, 1, true)
        order = AMMOrder(; id = agent.id, option = true, cost, n_shares)
        transact!(order, market, model, 1)
        pop!(model.trade_volume[1])
        pop!(model.market_prices[1])
    end
    if agent.shares[1][2] &gt; 0
        # sell no shares
        n_shares = -agent.shares[1][2]
        cost = shares_to_cost(market, n_shares, 1, false)
        order = AMMOrder(; id = agent.id, option = false, cost, n_shares)
        transact!(order, market, model, 1)
        pop!(model.trade_volume[1])
        pop!(model.market_prices[1])
    end

    price = compute_price(market, 1, true)
    belief = (1 - λ) * judgments[1][1] + λ * price
    if belief ≥ price
        # buy yes shares
        cost = compute_optimal_purchase(agent, market, belief, 1, true)
        n_shares = cost_to_shares(market, cost, 1, true)
        order = AMMOrder(; id = agent.id, option = true, cost, n_shares)
        transact!(order, market, model, 1)
    elseif belief &lt; price
        # buy no shares
        cost = compute_optimal_purchase(agent, market, belief, 1, false)
        n_shares = cost_to_shares(market, cost, 1, false)
        order = AMMOrder(; id = agent.id, option = false, cost, n_shares)
        transact!(order, market, model, 1)
    end
    return nothing
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">agent_step! (generic function with 5 methods)</code></pre><h2 id="Model-Initialization-Function"><a class="docs-heading-anchor" href="#Model-Initialization-Function">Model Initialization Function</a><a id="Model-Initialization-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Initialization-Function" title="Permalink"></a></h2><p>The function specified in the code block below initializes the model using parameter values provided by the user. The model contains agents and a CPMM without a spatial component. The keyword arguments for the function are defined as follows: </p><ul><li><code>agent_type</code>: the agent type used in the simlation</li><li><code>n_agents</code>: the number of agents in the simulation</li><li><code>λ</code>: the price weight parameter</li><li><code>money</code>: the initial amount of money available for each agent to buy shares</li><li><code>yes_reserves</code>: the number of reserves for <em>yes</em> shares</li><li><code>no_reserves</code>: the number of reserves for <em>no</em> shares</li><li><code>manipulate_time</code>: the time at which the market is manipulated</li></ul><p>The estimated price ranges from 0 to 1 across agents, such that the average estimate is .50.</p><pre><code class="language-julia hljs">function initialize(
    agent_type::Type{&lt;:CPMMAgent};
    n_agents,
    λ,
    money,
    yes_reserves,
    no_reserves,
    manipulate_time
)
    yes_reserves = deepcopy(yes_reserves)
    no_reserves = deepcopy(no_reserves)
    space = nothing
    model = StandardABM(
        agent_type,
        space;
        properties = CPMM(; yes_reserves, no_reserves, times = [manipulate_time]),
        model_step!,
        scheduler = Schedulers.Randomly()
    )
    for i ∈ 1:n_agents
        p = (i - 1) / (n_agents - 1)
        judgments = [[p, 1-p]]
        add_agent!(
            model;
            judgments,
            money,
            λ,
            shares = [zeros(2)]
        )
    end
    return model
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">initialize (generic function with 1 method)</code></pre><h2 id="Set-RNG-Seed"><a class="docs-heading-anchor" href="#Set-RNG-Seed">Set RNG Seed</a><a id="Set-RNG-Seed-1"></a><a class="docs-heading-anchor-permalink" href="#Set-RNG-Seed" title="Permalink"></a></h2><p>In the code block below, we set the seed for the random number generator to ensure reproducible results. </p><pre><code class="language-julia hljs">Random.seed!(5471)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Random.TaskLocalRNG()</code></pre><h2 id="Configure-Model"><a class="docs-heading-anchor" href="#Configure-Model">Configure Model</a><a id="Configure-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Configure-Model" title="Permalink"></a></h2><p>In the <code>NamedTuple</code> below, we will set the values for the keyword arguments passed to the <code>initialize</code> function. The parameter values were selected to reproduce Figure 1 (a) reported in Rasooly &amp; Rozzi (2025). </p><pre><code class="language-julia hljs">config = (
    n_agents = 11,
    λ = 0.0,
    money = 100,
    no_reserves = [1000.0],
    yes_reserves = [1000.0],
    manipulate_time = 100,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(n_agents = 11, λ = 0.0, money = 100, no_reserves = [1000.0], yes_reserves = [1000.0], manipulate_time = 100)</code></pre><h2 id="Simulate-the-Model"><a class="docs-heading-anchor" href="#Simulate-the-Model">Simulate the Model</a><a id="Simulate-the-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-the-Model" title="Permalink"></a></h2><p>Now that we have defined the agents and the model parameters, we are in the position to simulate the model. The code below runs the model 1000 times and returns a vector of 200 market prices per run. </p><pre><code class="language-julia hljs">market_prices = map(1:1000) do _
    model = initialize(CPMMAgent; config...)
    run!(model, 200)
    model.market_prices[1]
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1000-element Vector{Vector{Float64}}:
 [0.4524886877828055, 0.4477324694230083, 0.4801745824895639, 0.5194342857208619, 0.5130849450340592, 0.5130849450340594, 0.5110658032884317, 0.5110658032884319, 0.5113656856778853, 0.4826154777755965  …  0.5316737975647181, 0.5316737972396831, 0.5316739070013891, 0.5316738978379532, 0.5316738944834571, 0.531673894483457, 0.5316740687248238, 0.531674055767023, 0.5316740557670229, 0.5316740471219249]
 [0.48169631372795607, 0.48169631372795607, 0.530996129042322, 0.49070158391276747, 0.4907015839127674, 0.5006542531567131, 0.5379727504648673, 0.5347086472493027, 0.5348255123751512, 0.5348255123751512  …  0.528237922666021, 0.5282396374034545, 0.5282395098954297, 0.5281589408134781, 0.5281660381277518, 0.5281660381277518, 0.5281660381277516, 0.5281685768690797, 0.5281685768690796, 0.5281677357658785]
 [0.5, 0.5475113122171946, 0.5249161733187774, 0.5249161733187773, 0.5135494563573167, 0.4748788455949926, 0.4954753186509275, 0.4954753186509276, 0.49778163311864626, 0.4991665863794336  …  0.5278750612235928, 0.5278740832360249, 0.5278732158987136, 0.5278731988242804, 0.5278839955836218, 0.5278839955836219, 0.527883995583622, 0.5278524376651096, 0.5278540761949186, 0.5278573467013318]
 [0.5091059865213138, 0.5082782943802381, 0.47010650292592665, 0.47357192852460434, 0.5134454803317636, 0.5031162407298684, 0.5211325497280591, 0.4914827690768073, 0.4448209137719316, 0.45075917663534343  …  0.53293760272394, 0.5329448530532852, 0.5334079373313944, 0.5334079373313946, 0.5333790879687986, 0.5333790879687986, 0.5333790879687987, 0.5333790879687985, 0.5333790879687984, 0.533362492195294]
 [0.4908940134786863, 0.5194346858453109, 0.4700261154747992, 0.4718536638679071, 0.4744087326245876, 0.5142048320031039, 0.5145246130818829, 0.5223031378738423, 0.5218307525445178, 0.521557750732004  …  0.5302674329132518, 0.5302679904343344, 0.5302682025789558, 0.5302682025789558, 0.5302692034817409, 0.5302692034817409, 0.5302691588628919, 0.5302691588628919, 0.5302691588628918, 0.5302691048333128]
 [0.5373813247573764, 0.5156844115502469, 0.5051521737112721, 0.532359567695283, 0.5765916632041205, 0.5739175451808225, 0.5739175451808226, 0.519551481752639, 0.5268696571977658, 0.5299230377558668  …  0.5223878159323431, 0.522386877574349, 0.5223867507810828, 0.5223867507810829, 0.5223865786666416, 0.5223866220433766, 0.5223866297546913, 0.5223866297546913, 0.5223866297546913, 0.5223866252785981]
 [0.5475113122171946, 0.51548754491108, 0.5140802004908667, 0.5404437952161055, 0.49928862583086847, 0.5018156467797785, 0.5018156467797784, 0.5390224917191854, 0.5390224917191854, 0.5390224917191854  …  0.5242282475795906, 0.5242287536867514, 0.5242287096827543, 0.5242286940659378, 0.5242286954237575, 0.5242286954237575, 0.5242286954237575, 0.5242301710708439, 0.5242303712553851, 0.5242302982382543]
 [0.4524886877828055, 0.41978505357545387, 0.4746841685785368, 0.458729318914882, 0.458729318914882, 0.45872931891488206, 0.4624695565229188, 0.46246955652291877, 0.4383493223925034, 0.4376784881112421  …  0.5403071289265566, 0.5403071289265567, 0.5403072012151351, 0.5403085459154937, 0.5403085459154936, 0.5403084925834494, 0.5403084925834494, 0.5403084177945855, 0.5403096770616633, 0.5403100545097024]
 [0.5183036862720438, 0.4791863274852672, 0.4534631622632677, 0.5054105324588479, 0.5022153127437995, 0.5020139224731988, 0.5392016900325328, 0.5392016900325328, 0.5370580846660965, 0.5355985044166366  …  0.5296520764231997, 0.5296519994655922, 0.5296519994655922, 0.529652082273576, 0.5296520773041935, 0.5296520773041936, 0.5296520773041937, 0.529652077756888, 0.5296521494584956, 0.5296521494584956]
 [0.5373813247573764, 0.5248954342025507, 0.5043193470595487, 0.4762241773992389, 0.4311089999934946, 0.4005707490451751, 0.43696547790899193, 0.4903892435487358, 0.49038924354873586, 0.4920772279810555  …  0.5391488739608664, 0.5391488739608664, 0.5391488783161851, 0.5391489209964528, 0.5391489209964528, 0.5391486139926185, 0.5391486139926186, 0.5391485581513438, 0.539148583683528, 0.5391485836835281]
 ⋮
 [0.4908940134786863, 0.5291443685161761, 0.5355834030099502, 0.48464600446916223, 0.48519397853958346, 0.5048545927223573, 0.4670086944078624, 0.4699598625652007, 0.45444631000078817, 0.45562668094550507  …  0.5330276751450491, 0.5330258645983257, 0.5330259303583601, 0.5330259303583607, 0.5330252906520481, 0.5330252906520481, 0.5330277624261447, 0.5330276958846707, 0.533026530384266, 0.5330264171603153]
 [0.4723086923163467, 0.47230869231634665, 0.47230869231634665, 0.43762764809146, 0.46152004983366635, 0.46217816036795495, 0.5133237948163745, 0.4645053394844422, 0.44950213487421875, 0.45028373187292414  …  0.5346603180239303, 0.5346601659589983, 0.5346601659589983, 0.5346598655554052, 0.5346598818182915, 0.5347390930512965, 0.5347362105866295, 0.5347306203816274, 0.5347306203816274, 0.5347306203816274]
 [0.5, 0.4524886877828055, 0.41978505357545387, 0.45461570128009055, 0.4962152725060373, 0.49363824615178203, 0.5125267677599482, 0.5587852023131595, 0.5565567204256214, 0.5515919164031886  …  0.5331906340532723, 0.5331906320617575, 0.5331906320617575, 0.5331906256904698, 0.533190617895987, 0.5331903655642517, 0.5331897501448761, 0.5331898263423437, 0.5331898976648901, 0.5331896097963811]
 [0.5475113122171946, 0.5706671048908782, 0.5733106738742455, 0.566711610155627, 0.5667116101556271, 0.5667116101556271, 0.5667116101556271, 0.5787843587792912, 0.5776805450449828, 0.5776805450449827  …  0.5282103652173509, 0.5282103541917875, 0.5282282492398469, 0.5282276516357839, 0.5282260478766625, 0.528224955827233, 0.5282241129359484, 0.5282241772769105, 0.5282243072292742, 0.5282242952471584]
 [0.5475113122171946, 0.5432098765432098, 0.5432098765432098, 0.5115671570282686, 0.4730837108218285, 0.49384215589405894, 0.4949283030852148, 0.49934883927132656, 0.4984067567197429, 0.49840675671974294  …  0.5321893128036356, 0.532189068436679, 0.5321823522306252, 0.5321829547838802, 0.532184056567894, 0.5321839936966328, 0.5321839936966328, 0.5321843746104635, 0.532184671211918, 0.5321846712119179]
 [0.48169631372795607, 0.5110865896452361, 0.5283654359604059, 0.5348758717848271, 0.5226141511205191, 0.4928288090204717, 0.4939459577231526, 0.4939459577231525, 0.5319061956316941, 0.5321672026201308  …  0.5254130844252116, 0.5254130829111425, 0.5254130696872485, 0.5254130830673148, 0.5254130821789543, 0.5254130821789543, 0.5254130822105543, 0.5254130822445795, 0.5254130823209969, 0.5254130823209968]
 [0.5373813247573764, 0.506258874114378, 0.4581301264974426, 0.4710165478939989, 0.4731694101220207, 0.5033391800831654, 0.5014137588187402, 0.49217885297191083, 0.49288978725432886, 0.49288978725432886  …  0.531135372667687, 0.5311353726676871, 0.5311358481536748, 0.5311349533293772, 0.5311339958271156, 0.5311339958271156, 0.531134108025533, 0.5311343446024892, 0.5311343253239108, 0.5311343253239107]
 [0.48169631372795607, 0.4460909016015294, 0.40411251335217163, 0.4602970807001579, 0.46196174340312385, 0.5028991066556561, 0.530318402413668, 0.4998322015697879, 0.4998322015697878, 0.4999422446078429  …  0.5400576173971994, 0.5400576173971994, 0.5400576173971994, 0.5400556239213479, 0.5400557798687017, 0.5400520747432955, 0.5400520747432955, 0.5400333644203028, 0.5400348499154196, 0.5400365667557646]
 [0.5373813247573764, 0.48627659691121494, 0.48627659691121494, 0.48627659691121494, 0.4881121805193299, 0.5367910877356429, 0.5609825650861375, 0.5609825650861375, 0.564507812026097, 0.5767876222315275  …  0.5242116062812653, 0.5242135446738637, 0.5242092641922909, 0.5242100610582484, 0.5242106915651817, 0.5242107701838414, 0.5242107701838414, 0.5242107701838415, 0.5242107616631527, 0.5242106304297883]</code></pre><h2 id="Plot-the-Results"><a class="docs-heading-anchor" href="#Plot-the-Results">Plot the Results</a><a id="Plot-the-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-Results" title="Permalink"></a></h2><p>The code block below plots the price as a function of time averaged across the 1000 simulations. The dashed line denotes the expected price based on the beliefs of the agents. At day 100, a manipulator inflates the price by 5 cents. The true price shows a gradual, but partial recovery, which suggests that price manipulation can have an enduring effect. </p><pre><code class="language-julia hljs">plot(
    mean(market_prices),
    ylims = (.39, .61),
    xlabel = &quot;Day&quot;,
    ylabel = &quot;Price of Yes Share&quot;,
    linewidth = 2.5,
    grid = false,
    leg = false,
)
hline!([.5], color = :black, linestyle = :dash)</code></pre><img src="5b5880bc.svg" alt="Example block output"/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>Rasooly, I., &amp; Rozzi, R. (2025). How manipulable are prediction markets?. arXiv preprint arXiv:2503.03312.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../arbitrage_example/">« Arbitrage Example</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 7 August 2025 16:36">Thursday 7 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
